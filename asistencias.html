<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asistencias - EDEC Apodaca</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        body { visibility: hidden; }
    </style>
</head>
<body class="buscador-page">
    <script>
        // Verificaci√≥n inmediata antes de renderizar contenido
        (function() {
            const isLoggedIn = localStorage.getItem('isLoggedInBuscador');
            if (isLoggedIn !== 'true') {
                window.location.replace('asistenciaslogin.html');
                return;
            }
            document.body.style.visibility = 'visible';
        })();
    </script>
    <div class="buscador-container">
        <button class="btn-cerrar-sesion" id="btnCerrarSesion">Cerrar Sesi√≥n</button>
        <h1>Asistencia Apodaca</h1>
        
        <div class="buscador-header">
            <button class="btn-filtros" id="btnFiltros">üîç Filtros</button>
            <input 
                type="text" 
                id="inputBuscarMatricula" 
                class="input-buscar" 
                placeholder="Buscar por matr√≠cula..."
            >
            <button class="btn-buscar" id="btnBuscar">Buscar</button>
            <button class="btn-fichados" id="btnFichados">Fichados</button>
        </div>

        <!-- Overlay para la ventana flotante -->
        <div class="filtros-overlay" id="filtrosOverlay" style="display: none;"></div>
        
        <!-- Ventana flotante de filtros -->
        <div class="panel-filtros" id="panelFiltros" style="display: none;">
            <button class="btn-cerrar-filtros" id="btnCerrarFiltros">√ó</button>
            <h3>Filtros de B√∫squeda</h3>
            <div class="filtro-grupo">
                <label for="filtroDia">Filtrar por d√≠a (1-31):</label>
                <input 
                    type="number" 
                    id="filtroDia" 
                    class="input-filtro"
                    min="1"
                    max="31"
                    placeholder="D√≠a"
                >
                <button class="btn-limpiar-filtro" id="btnLimpiarDia">Limpiar</button>
            </div>
            <div class="filtro-grupo">
                <label for="filtroMes">Filtrar por mes (1-12):</label>
                <input 
                    type="number" 
                    id="filtroMes" 
                    class="input-filtro"
                    min="1"
                    max="12"
                    placeholder="Mes"
                >
                <button class="btn-limpiar-filtro" id="btnLimpiarMes">Limpiar</button>
            </div>
        </div>

        <div class="tabla-container">
            <table class="tabla-asistencias" id="tablaAsistencias">
                <thead>
                    <tr>
                        <th>Matr√≠cula</th>
                        <th>Nombre</th>
                        <th>Fecha</th>
                        <th>Hora</th>
                    </tr>
                </thead>
                <tbody id="tbodyAsistencias">
                    <!-- Las filas se agregar√°n din√°micamente -->
                </tbody>
            </table>
        </div>

        <div id="mensajeSinResultados" class="mensaje-sin-resultados" style="display: none;">
            No se encontraron resultados.
        </div>

        <!-- Contenedor de fichados (oculto por defecto) -->
        <div id="contenedorFichados" style="display: none;">
            <div class="fichados-header">
                <button class="btn-regresar" id="btnRegresar">‚Üê Regresar</button>
                <h2>Alumnos Fichados</h2>
            </div>
            <div class="tabla-container">
                <table class="tabla-fichados" id="tablaFichados">
                    <thead>
                        <tr>
                            <th>Matr√≠cula</th>
                            <th>Nombre</th>
                            <th>Programa</th>
                            <th>Fichas</th>
                        </tr>
                    </thead>
                    <tbody id="tbodyFichados">
                        <tr>
                            <td colspan="4" style="text-align: center;">Cargando fichados...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="js/authGuard_asistencias.js"></script>
    <script src="js/asistencias_buscador.js"></script>
</body>
</html>
